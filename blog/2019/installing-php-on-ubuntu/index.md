# installing php on ubuntu

[installing php on ubuntu](https://aregsar.com/blog/2019/installing-php-on-ubuntu)

## Introduction

In this post I will detail the steps to take to install PHP onto an Ubuntu 18 OS.

The instructions here can be applied to other Linux distributions and to the the Windows 10 subsystem for Linux WSL with minor changes.

> Note the upcoming Windows WSL2 will provide native Linux support on the Windows 10 platform.

## Testing the install with Docker

If you have Docker installed on your machine you can bring up an Ubuntu container (or any other Linux container) running bash in interactive mode to test the installation before running it on your machine.

Here is the command to run bash in the Ubuntu 18.04 container:

`docker run -ti --rm ubuntu:bionic bash`

It will take a little bit of time to download the docker image, the first time you run this command. But subsequent runs will be very quick.

> Note: Any of the changes below that you make to the running container will be lost if you exit the container.

# Installing PHP using the APT package manager


Before installing the PHP files we should update our package manager and we need to add the package repository from which we will retrieve the PHP distribution.

```bash
#update the apt package manager
apt-get update
#install the package that allows us to add the PHP repository
apt-get install software-properties-common -y --no-install-recommends
#add the PHP package repostory
add-apt-repository ppa:ondrej/php -y
```

Now we are setup to install PHP.

Run the following bash commands to install the PHP CLI and the PHP-FPM service along with some PHP extensions

```bash
apt-get install -y --no-install-recommends \
php7.3 \
php7.3-fpm \
php7.3-mbstring \
php7.3-bcmath \
php7.3-xml \
php7.3-xmlrpc \
php7.3-zip \
php7.3-sqlite3 \
php7.3-mysql \
php7.3-pgsql \
php7.3-imap \
php7.3-readline \
php7.3-phpdbg \
php7.3-curl \
php7.3-dev \
php-pear \
php-ssh2 \
php-yaml \
php-memcached \
php-redis \
php-apcu \
php-xdebug \
php-xhprof \
curl \
unzip
```

> Note: installing the php7.3 package installs php7.3-cli php7.3-common php7.3-json and php7.3-opcache and other PHP extensions

Next run the following to clean up temporary files generated by the installation

```bash
apt-get -y autoremove && apt-get clean
rm -rf /tmp/* /var/tmp/* /usr/share/doc/*
```

Finally run the following to eliminate an issue between the PHP composer package manager and PHP v7.3 JIT compiler.
Without this change for PHP v7.3, if we install the Composer package manager and try to install PHP packages with it we will get an error.

```bash
sed -i 's/;pcre.jit=1/pcre.jit=0/g' /etc/php/7.3/cli/php.ini
sed -i 's/;pcre.jit=1/pcre.jit=0/g' /etc/php/7.3/fpm/php.ini
```

The above statements uncomment and set the value of the `pcre.jit` setting in the php.ini configuration files.

You can run the following commands before and after replacing the JIT setting to verify the settings are updated in their respective php.ini files.

`cat /etc/php/7.3/cli/php.ini | grep ';pcre.jit=1'`
`cat /etc/php/7.3/fpm/php.ini | grep ';pcre.jit=1'`

## The installation directories and configuration

The PHP CLI and PHP-FPM configuration file will be located at:

/etc/php/7.3/cli/php.ini

/etc/php/7.3/fpm/php.ini
/etc/php/7.3/fpm/php-fpm.conf

Each PHP extension will have its own configuration .ini file in /etc/php/7.3/mods-available/

examples:
/etc/php/7.3/mods-available/opcache.ini
/etc/php/7.3/mods-available/xdebug.ini
/etc/php/7.3/mods-available/pdo_mysql.ini

The /etc/php/7.3/cli/conf.d/ and /etc/php/7.3/fpm/conf.d/ directories will have symlinks to the /etc/php/7.3/mods-available/ files:

10-opcache.ini -> /etc/php/7.3/mods-available/opcache.ini
20-xdebug.ini -> /etc/php/7.3/mods-available/xdebug.ini